//заглушка для УТ 10.3

Процедура ДобавитьПрефиксУзла(Префикс) Экспорт
	
КонецПроцедуры

Процедура ДобавитьПрефиксОрганизации(ДокументОбъект, Префикс) Экспорт
	
	Префикс = "0";
	
	МетаданныеДокумента = ДокументОбъект.Метаданные();
	
	Если НЕ МетаданныеДокумента.Реквизиты.Найти("Отправитель") = Неопределено Тогда
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		|	ВЫБОР
		|		КОГДА НЕ _Отправитель.ХозяйствующийСубъект ЕСТЬ NULL
		|			ТОГДА _ОтправительОрганизация.Объект
		|		КОГДА НЕ _Получатель.ХозяйствующийСубъект ЕСТЬ NULL
		|			ТОГДА _ПолучательОрганизация.Объект
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК Организация,
		|	ВЫБОР
		|		КОГДА НЕ _Отправитель.ХозяйствующийСубъект ЕСТЬ NULL
		|			ТОГДА _ОтправительОрганизация.Объект.Префикс
		|		КОГДА НЕ _Получатель.ХозяйствующийСубъект ЕСТЬ NULL
		|			ТОГДА _ПолучательОрганизация.Объект.Префикс
		|		ИНАЧЕ НЕОПРЕДЕЛЕНО
		|	КОНЕЦ КАК Префикс
		|ИЗ
		|	(ВЫБРАТЬ
		|		ВЫРАЗИТЬ(&Отправитель КАК Справочник.Контрагенты) КАК Отправитель,
		|		ВЫРАЗИТЬ(&Получатель КАК Справочник.Контрагенты) КАК Получатель) КАК _Таблица
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ВетисНастройкиХС КАК _Отправитель
		|		ПО _Таблица.Отправитель = _Отправитель.ХозяйствующийСубъект
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СобственныеКонтрагенты КАК _ОтправительОрганизация
		|		ПО _Таблица.Отправитель = _ОтправительОрганизация.Контрагент
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ВетисНастройкиХС КАК _Получатель
		|		ПО _Таблица.Получатель = _Получатель.ХозяйствующийСубъект
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СобственныеКонтрагенты КАК _ПолучательОрганизация
		|		ПО _Таблица.Получатель = _ПолучательОрганизация.Контрагент
		|ГДЕ
		|	ИСТИНА");
		
		//если отправитель и получатель свои, то приоритет у отправителя, если он есть в собственных контрагентах
		
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "ВетисВетеринарноСопроводительныйДокумент", МетаданныеДокумента.Имя);
		
		Запрос.УстановитьПараметр("Отправитель" , ДокументОбъект.Отправитель);
		Запрос.УстановитьПараметр("Получатель" , ДокументОбъект.Получатель);
		
		Выборка = Запрос.Выполнить().Выбрать();
		
		Если Выборка.Следующий() И ЗначениеЗаполнено(Выборка.Префикс) Тогда
			Префикс = Выборка.Префикс;
		КонецЕсли;
	КонецЕсли;
	
Конецпроцедуры
